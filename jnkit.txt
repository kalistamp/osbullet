#!/usr/bin/env python3

import requests
import re
from bs4 import BeautifulSoup

# Function to extract all text between ANY HTML tags
def extract_all_text(html_content):
    # First remove all script and style elements
    soup = BeautifulSoup(html_content, 'html.parser')
    for script in soup(['script', 'style']):
        script.decompose()
    
    # Get all text
    text = soup.get_text(separator='\n')
    
    # Clean up the text
    lines = (line.strip() for line in text.splitlines())
    chunks = (phrase.strip() for line in lines for phrase in line.split("  "))
    
    # Drop blank lines and join
    return '\n'.join(chunk for chunk in chunks if chunk)

# Main script
url = "https://www.wantstobehired.com/"
headers = {'User-Agent': 'Mozilla/5.0'}

print("Starting text extraction...")

with open('webpage_text.txt', 'w', encoding='utf-8') as outfile:
    for page in range(1, 95):
        try:
            print(f"\nGetting page {page}")
            
            # Get page URL
            page_url = f"{url}?page={page}" if page > 1 else url
            
            # Get page content
            response = requests.get(page_url, headers=headers)
            
            # Extract all text
            text = extract_all_text(response.text)
            
            # Write to file
            outfile.write(f"\n\n=== PAGE {page} ===\n\n")
            outfile.write(text)
            
        except Exception as e:
            print(f"Error on page {page}: {e}")

print("\nDone! Check webpage_text.txt")
